<%inherit file="base.html" />

<%def name="body()">
   <div class="table_wrapper">
   <div id="paddingheader">
      <h1 class="clearfix"><img src="interfaces/default/images/icon_search.png" alt="Search results"/>Search Result</h1>
   </div>
   <table class="display" id="searchresults_table">
       <thead>
           <tr>
               <th colspan="3"><a onclick="changeDisplayBody('artists')">Artistas</a></th>
            </tr>
         <tr id="artists">
            <th id="artistname">Artist Name</th>
            <th id="score">Score</th>
            <th id="add"></th>
         </tr>
      </thead>
      <tbody id="artists">
         %if searchresults:
            %for result in searchresults['Artists']:
            <%
               result['score'] = result['PopularityIndex']/1000
               if result['score'] == 100:
                  grade = 'A'
               else:
                  grade = 'Z'
            %>
            <tr class="grade${grade}">
               <td id="artistname"><a title="${result['ArtistName']}">${result['ArtistName']}</a></td>
               <td id="score"><div class="bar"><div class="score" style="width: ${result['score']}px">${result['score']}</div></div></td>
               <td id="add"><a href="addArtist?artistid=${result['ArtistID']}"><span class="ui-icon ui-icon-plus"></span> Add this artist</a></td>
            </tr>
            %endfor
         %endif
      </tbody>
      <thead>
          <tr>
              <th colspan="3"><a onclick="changeDisplayBody('albums')">Albums</a></th>
          </tr>
          <tr id="albums">
              <th id="albumname">Album Name</th>
              <th id="score">Score</th>
              <th id="add"></th>
           </tr>
      </thead>
      <tbody id="albums">
        %if searchresults:
            %for result in searchresults['Albums']:
            <%
                result['score'] = result['PopularityIndex']/1000
                if result['score'] == 100:
                    grade = 'A'
                else:
                    grade = 'Z'
            %>
            <tr class="grade${grade}">
                <td id="albumname"><a title="${result['AlbumName']}">${result['AlbumName']}<a></td>
                <td id="score"><div class="bar"><div class="score" style="width: ${result['score']}px">${result['score']}</div></div></td>
                <td id="add"><a href="addArtist?artistid=${result['ArtistID']}"><span class="ui-icon ui-icon-plus"></span> Add this artist</a></td>
            </tr>
            %endfor
        %endif
      </tbody>
      <thead>
          <tr>
              <th colspan="3"><a onclick="changeDisplayBody('songs')">Songs</a></th>
          </tr>
          <tr id="songs">
              <th id="songname">Song Name</th>
              <th id="score">Score</th>
              <th id="add"></th>
           </tr>
      </thead>
      <tbody id="songs">
        %if searchresults:
            %for result in searchresults['Songs']:
            <%
                result['score'] = result['PopularityIndex']/1000
                if result['score'] == 100:
                    grade = 'A'
                else:
                    grade = 'Z'
            %>
            <tr class="grade${grade}">
                <td id="songname"><a title="${result['SongName']}">${result['SongName']}<a></td>
                <td id="score"><div class="bar"><div class="score" style="width: ${result['score']}px">${result['score']}</div></div></td>
                <td id="add"><a href="addArtist?artistid=${result['ArtistID']}"><span class="ui-icon ui-icon-plus"></span> Add this artist</a></td>
            </tr>
            %endfor
        %endif
      </tbody>
   </table>
   </div>
</%def>

<%def name="headIncludes()">
   <link rel="stylesheet" href="interfaces/default/css/data_table.css">
</%def>

<%def name="javascriptIncludes()">

   <script src="js/libs/jquery.dataTables.min.js"></script>
   
   <script>
   function changeDisplayBody(eID)
   {
           $('tbody#' + eID).toggle(400, "swing");
           $('tr#' + eID).toggle(400, "swing");
               return false;
   }
   function getArt() {
      $("table#searchresults_table tr td#albumart img").each(function(){   
         var id = $(this).attr('title');
         var image = $(this);
         if ( !image.hasClass('done') ) {
            image.addClass('done');
            getImageLinks(image,id,"${type}");
         }
      });
   }
   function initThisPage() {
      getArt();
      $('#searchresults_table').dataTable(
         {
            "bDestroy": true,
            "aoColumnDefs": [
                   { 'bSortable': false, 'aTargets': [ 0,3 ] }
            ], 
            "oLanguage": {
               "sLengthMenu":"Show _MENU_ results per page",
               "sEmptyTable": "No results",
               "sInfo":"Showing _START_ to _END_ of _TOTAL_ results",
               "sInfoEmpty":"Showing 0 to 0 of 0 results",
               "sInfoFiltered":"(filtered from _MAX_ total results)",
               "sSearch" : ""},
            "iDisplayLength": 25,
            "sPaginationType": "full_numbers",
            "aaSorting": []
         });
         resetFilters("album");
   }
   $(document).ready(function(){
         initThisPage();      
   });
   $(window).load(function(){
      initFancybox();
   });
   </script>
</%def>
